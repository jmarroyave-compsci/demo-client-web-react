"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4606],{54606:function(e,r,t){t.d(r,{Z:function(){return de}});var n,o=t(4942),c=t(67294),i=t(55619),a={automata:{name:"story-genre-timeline"},page:{title:"Genre timeline",description:"",url:function(e){var r=e.entity,t=e.genre;return"/".concat(r,"/stories/genre-timeline/").concat(t)}},banner:{showData:!0,renderer:"marquee"}},u=t(15861),s=t(87757),l=t.n(s),p=t(24268),f=t(80105),d=t(11163),j=t(1015);function O(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?O(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g=a.automata.name,b=(0,p.hg)("".concat(g,"/fetchTopic"),function(){var e=(0,u.Z)(l().mark((function e(r,t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.S)(r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()),h=(0,p.hg)("".concat(g,"/fetchData"),function(){var e=(0,u.Z)(l().mark((function e(r,t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch(m(r)),r.decade=0,e.next=4,(0,j.E)(r);case 4:return(n=e.sent).data=[{timeline:n.data}],e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()),v=(0,p.oM)({name:g,initialState:{params:{renderer:null,entity:null,page:null,genre:null},data:null,loading:!0,error:null,topic:{data:null,loading:!0,error:null}},reducers:{setParams:function(e,r){e.params=y(y({},e.params),r.payload),"banner"!=e.params.renderer&&d.default.push("".concat(a.page.url(e.params),"?page=").concat(e.params.page),null,{shallow:!0})}},extraReducers:(n={},(0,o.Z)(n,h.pending,(function(e,r){e.data=null,e.loading=!0,e.error=""})),(0,o.Z)(n,h.fulfilled,(function(e,r){var t=r.payload,n=t.loading,o=t.error,c=t.data;e.data=c,e.loading=n,e.error=o})),(0,o.Z)(n,h.rejected,(function(e,r){var t=r.error;e.data=[],e.loading=!1,e.error=t})),(0,o.Z)(n,b.pending,(function(e,r){e.topic.data=null,e.topic.loading=!0,e.topic.error=""})),(0,o.Z)(n,b.fulfilled,(function(e,r){var t=r.payload,n=t.loading,o=t.error,c=t.data;e.topic.data=c,e.topic.loading=n,e.topic.error=o})),(0,o.Z)(n,b.rejected,(function(e,r){var t=r.error;e.topic.data=[],e.topic.loading=!1,e.topic.error=t})),n)});f.h.reducerManager.add(g,v.reducer);v.reducer;var m=v.actions.setParams,w=t(39698),x=t(50367),P=t(39704),Z=t(26447),E=t(90461),D=t(9573),k=t(38732),C=t(98102),S=t(56011),T=t(3694),I=t(85893);function N(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var R=function(e){var r=e.data,t=e.onExit,n=e.topic,i=(0,c.useState)({}),a=i[0],u=i[1],s=function(e,r){return r?"rgba(0,0,0,0.4)":e%2==0?"rgba(0,0,0,0.1)":"inherit"};return(0,c.useEffect)((function(){var e;if(null!==r&&void 0!==r&&null!==(e=r.topic)&&void 0!==e&&e.data){var t={},n={};r.topic.data.forEach((function(e){t[e.year]||(t[e.year]={}),n[e.genre]||(n[e.genre]={})}));var c={};Object.keys(n).forEach((function(e){return c[e]=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?N(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},t)})),r.topic.data.forEach((function(e){c[e.genre][e.year]=1})),u(c)}}),[r]),(0,I.jsxs)("div",{children:[(0,I.jsxs)(Z.Z,{direction:"row",style:{marginBottom:"1rem"},children:[(0,I.jsx)(E.Z,{label:n,onDelete:t}),(0,I.jsx)("div",{style:{flex:1}})]}),(0,I.jsx)("div",{style:{fontSize:"0.6rem",width:"100%",maxHeight:"400px",overflow:"auto"},children:(0,I.jsxs)(D.Z,{size:"small",stickyHeader:!0,children:[(0,I.jsx)(S.Z,{children:(0,I.jsxs)(T.Z,{children:[(0,I.jsx)(C.Z,{children:"\xa0"}),Object.keys(a).slice(0,1).map((function(e){return Object.keys(a[e]).map((function(e){return(0,I.jsx)(C.Z,{align:"center",children:e},e)}))})),(0,I.jsx)(C.Z,{children:"\xa0"})]})}),(0,I.jsx)(k.Z,{children:Object.keys(a).map((function(r,t){return(0,I.jsxs)(T.Z,{style:{backgroundColor:s(t,!1)},children:[(0,I.jsx)(C.Z,{style:{backgroundColor:s(0,r==e.genre)},children:r}),Object.keys(a[r]).map((function(t){return(0,I.jsx)(C.Z,{style:{backgroundColor:s(0,t==e.year||r==e.genre)},align:"center",children:1==a[r][t]?"\u2713":" "})})),(0,I.jsx)(C.Z,{style:{backgroundColor:s(0,r==e.genre)},children:r})]},t)}))})]})})]})},_=t(2734),L=t(74187);function G(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function H(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?G(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var M=function(e){var r=(0,_.Z)(),t=e.data,n=e.topic;return(0,I.jsx)("div",{children:(0,I.jsx)("div",{style:{fontSize:"0.6rem",width:"100%",maxHeight:"400px",overflow:"auto"},children:(0,I.jsxs)(D.Z,{size:"small",stickyHeader:!0,children:[(0,I.jsx)(S.Z,{children:(0,I.jsx)(T.Z,{children:t.map((function(e){return(0,I.jsx)(C.Z,{align:"center",children:e.year},e.year)}))})}),(0,I.jsx)(k.Z,{children:[0,1,2,3,4,5,6,7,8,9].map((function(o){return(0,I.jsx)(T.Z,{children:t.map((function(t,c){var i;return(0,I.jsx)(C.Z,{onClick:function(){var r;return function(r){e.onTopicClick&&e.onTopicClick(r)}(null===(r=t.words[o])||void 0===r?void 0:r.p)},style:H({fontWeight:n===(null===(i=t.words[o])||void 0===i?void 0:i.p)?"bold":"inherit"},(0,L.$)(r,o)),align:"center",children:t.words[o]?t.words[o].p.split(",").join(" "):"-"},c)}))},o)}))})]})})})},z=t(14308),U=t(28973);function Q(e){return(0,I.jsx)(x.X,{children:(0,I.jsx)(z.Z,{spacing:1,sx:{padding:"1rem",display:"flex",flexGrow:1},children:(0,I.jsx)(U.Z,{variant:"rectangular",height:300})})})}function W(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function X(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?W(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var A={showLines:!0,showTimeline:!1,topic:""};function q(e,r){var t;switch(r.type){case"INIT":return X(X({},e),{},{showLines:!0,showTimeline:!1,topic:""});case"SELECT_WORD":return X(X({},e),{},{showLines:!1,showTimeline:!0,topic:r.payload.topic});case"EXIT_TIMELINE":return X(X({},e),{},{showLines:!0,showTimeline:!1,topic:""});default:throw new Error("operation ".concat(null===(t=r.type)||void 0===t?void 0:t.toUpperCase()," not implemented"))}}var B=function(e){var r=(0,P.I0)(),t=(0,P.v9)((function(e){return e["story-genre-timeline"]})),n=e.data,o=e.genre,i=e.year,a=e.loading,u=(0,c.useReducer)(q,A),s=u[0],l=u[1];return null==n||a?(0,I.jsx)(Q,{}):(0,I.jsxs)("div",{children:[(0,I.jsx)(M,{topic:s.topic,data:n,onTopicClick:function(e){l({type:"SELECT_WORD",payload:{topic:e}}),r(b({entity:"movie",topic:e}))}}),(0,I.jsx)("br",{}),(0,I.jsx)("br",{}),s.showTimeline&&(0,I.jsx)(R,{topic:s.topic,genre:o,year:i,data:t,onExit:function(e){l({type:"EXIT_TIMELINE"})}})]})};function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function J(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?F(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var $=function(e){var r=e.genre,t=e.header,n=void 0===t||t;return(0,I.jsxs)("div",{style:{padding:"1rem",width:"100%"},children:[n&&(0,I.jsx)(x.RQ,{children:(0,I.jsx)(w.Dx,{children:r.toUpperCase()})}),(0,I.jsx)(B,J(J({},e),{},{data:e.timeline}))]})},K=t(45688),V=t(24463),Y=t(86547),ee=t(15121),re=t(52871),te=t(72642);function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ce={genre:null};function ie(e,r){var t;switch(r.type){case"INIT":return oe(oe({},e),{},{genre:r.payload.genre?r.payload.genre:e.genre});case"GENRE_CHANGE":return oe(oe({},e),{},{genre:r.payload});default:throw new Error("operation ".concat(null===(t=r.type)||void 0===t?void 0:t.toUpperCase()," not implemented"))}}function ae(e){var r=(0,c.useState)(!1),t=(r[0],r[1],(0,c.useReducer)(ie,ce)),n=t[0],o=t[1],i=e.params,a=e.onChange,u=(0,c.useMemo)((function(){return(0,re.J)().map((function(e){return{label:e,id:e}}))}),[]);(0,c.useEffect)((function(){o({type:"INIT",payload:{genre:u.find((function(e){return e.id==i.genre}))}})}),[i]);return n.genre?(0,I.jsx)(x.RQ,{children:(0,I.jsxs)(z.Z,{spacing:2,children:[(0,I.jsx)(ee.Z,{id:"genre",disableClearable:!0,options:u,value:n.genre,onChange:function(e,r){return o({type:"GENRE_CHANGE",payload:r})},sx:{width:300},renderInput:function(e){return(0,I.jsx)(Y.Z,oe(oe({},e),{},{label:"Genre"}))}}),(0,I.jsx)(x.RQ,{children:(0,I.jsx)(te.Z,{variant:"outlined",onClick:function(){!function(){var e={genre:n.genre.id};a&&a(e)}()},children:"Filter"})})]})}):null}function ue(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function se(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ue(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ue(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var le=function(e){var r=e.data,t=e.loading,n=e.fetch,o=e.params;return e.item,(0,I.jsxs)(z.Z,{children:[(0,I.jsx)(V.Z,{onChange:function(e){n(se(se({},e),{},{page:1}))},filters:function(e){var r=e.onChange;return(0,I.jsx)(ae,{onChange:r,params:o})}}),(0,I.jsx)(B,{loading:t,data:r?r[0].timeline:null})]})};function pe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function fe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?pe(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function de(e){return(0,I.jsx)(i.Z,{params:e,config:a,fetch:function(e){return h(e)},item:function(r){return(0,I.jsx)($,fe(fe({type:e.type},r),{},{header:"banner"!=e.render}))},mainCol:function(e){return(0,I.jsx)(le,fe({},e))},customTitle:function(e){return"".concat(a.page.title,": ").concat(e.genre)},customDescription:function(e){return e.genre?(0,I.jsx)(K.C,{tag:e.genre}):""},customUrl:function(e){return a.page.url(e)}})}}}]);